Lower Level APIs for Forward and Reverse Mode AD in autodiffr
================
Changcheng Li
2018/6/4

## Introduction

`autodiffr` is now a work-in-progress. You can install it by

``` r
devtools::install_github("Non-Contradiction/autodiffr")
```

Itâ€™s also recommended to install the latest version of `JuliaCall` by

``` r
devtools::install_github("Non-Contradiction/JuliaCall")
```

And after the installation is finished, just do the following steps,
note that the first time it will take some time, but the next time it
should be better.

``` r
library(autodiffr)
ad_setup()
```

    ## Julia version 0.6.2 at location /Applications/Julia-0.6.app/Contents/Resources/julia/bin will be used.

    ## Loading setup script for JuliaCall...

    ## Finish loading setup script for JuliaCall.

And we can use package `numDeriv` to compare with `autodiffr`.

``` r
library(numDeriv)
```

    ## 
    ## Attaching package: 'numDeriv'

    ## The following objects are masked from 'package:autodiffr':
    ## 
    ##     grad, hessian, jacobian

## Basic Usage

In this section, we are using a function similar to Rosenbrock function
as an initial
example:

``` r
## Later on, I may export these functions maybe in an R environment including all testing functions.
## So users can get easy access to these functions for examples, testing and benchmarking purposes.
## But currently these functions are unexported in autodiffr
rosen1 <- autodiffr:::rosenbrock_1
# And there are other functions, which can be used to replace the rosen1 function in the following examples like
# rosen2 <- autodiffr:::rosenbrock_2
# rosen4 <- autodiffr:::rosenbrock_4
# ackley <- autodiffr:::ackley

rosen1
```

    ## function(x){
    ##     a <- 1
    ##     b <- 100 * a
    ##     result <- 0
    ##     for (i in 1:(length(x) - 1)) {
    ##         result <- result + (a - x[i])^2 + b*(x[i + 1] - x[i]^2)^2
    ##     }
    ##     result
    ## }
    ## <bytecode: 0x7fcbe8aab638>
    ## <environment: namespace:autodiffr>

``` r
# rosen2
# rosen4
# ackley

target <- rosen1
```

These functions receive a vector input and generates scalar output. So
`forward.grad` and `reverse.grad` can be used to calculate their
gradients and `forward.hessian` and `reverse.hessian` can be used to
calculate their hessians. Besides, it should be possible to calculate
the jacobian of the gradient function, which should be the same with the
hessian.

The basic usage is as follows:

``` r
X <- runif(10)
X
```

    ##  [1] 0.4337131 0.2039927 0.7401696 0.3194050 0.2348524 0.7513689 0.7955340
    ##  [8] 0.8692066 0.6812592 0.7091772

``` r
forward.grad(target, X)
```

    ##  [1]  -3.888505 -55.415065 206.827204 -64.021398 -40.366665  69.325287
    ##  [7] -29.417345  72.824136 -82.270277  49.012622

``` r
reverse.grad(target, X)
```

    ##  [1]  -3.888505 -55.415065 206.827204 -64.021398 -40.366665  69.325287
    ##  [7] -29.417345  72.824136 -82.270277  49.012622

``` r
forward.jacobian(function(x) forward.grad(target, x), X)
```

    ##            [,1]       [,2]       [,3]      [,4]       [,5]       [,6]
    ##  [1,]  146.1314 -173.48524    0.00000    0.0000    0.00000    0.00000
    ##  [2,] -173.4852  -44.13221  -81.59709    0.0000    0.00000    0.00000
    ##  [3,]    0.0000  -81.59709  731.65931 -296.0679    0.00000    0.00000
    ##  [4,]    0.0000    0.00000 -296.06785  230.4825 -127.76200    0.00000
    ##  [5,]    0.0000    0.00000    0.00000 -127.7620  -32.36078  -93.94096
    ##  [6,]    0.0000    0.00000    0.00000    0.0000  -93.94096  561.25267
    ##  [7,]    0.0000    0.00000    0.00000    0.0000    0.00000 -300.54756
    ##  [8,]    0.0000    0.00000    0.00000    0.0000    0.00000    0.00000
    ##  [9,]    0.0000    0.00000    0.00000    0.0000    0.00000    0.00000
    ## [10,]    0.0000    0.00000    0.00000    0.0000    0.00000    0.00000
    ##            [,7]      [,8]      [,9]     [,10]
    ##  [1,]    0.0000    0.0000    0.0000    0.0000
    ##  [2,]    0.0000    0.0000    0.0000    0.0000
    ##  [3,]    0.0000    0.0000    0.0000    0.0000
    ##  [4,]    0.0000    0.0000    0.0000    0.0000
    ##  [5,]    0.0000    0.0000    0.0000    0.0000
    ##  [6,] -300.5476    0.0000    0.0000    0.0000
    ##  [7,]  613.7665 -318.2136    0.0000    0.0000
    ##  [8,] -318.2136  836.1205 -347.6827    0.0000
    ##  [9,]    0.0000 -347.6827  475.2660 -272.5037
    ## [10,]    0.0000    0.0000 -272.5037  200.0000

``` r
reverse.jacobian(function(x) reverse.grad(target, x), X)
```

    ##            [,1]       [,2]       [,3]      [,4]       [,5]       [,6]
    ##  [1,]  146.1314 -173.48524    0.00000    0.0000    0.00000    0.00000
    ##  [2,] -173.4852  -44.13221  -81.59709    0.0000    0.00000    0.00000
    ##  [3,]    0.0000  -81.59709  731.65931 -296.0679    0.00000    0.00000
    ##  [4,]    0.0000    0.00000 -296.06785  230.4825 -127.76200    0.00000
    ##  [5,]    0.0000    0.00000    0.00000 -127.7620  -32.36078  -93.94096
    ##  [6,]    0.0000    0.00000    0.00000    0.0000  -93.94096  561.25267
    ##  [7,]    0.0000    0.00000    0.00000    0.0000    0.00000 -300.54756
    ##  [8,]    0.0000    0.00000    0.00000    0.0000    0.00000    0.00000
    ##  [9,]    0.0000    0.00000    0.00000    0.0000    0.00000    0.00000
    ## [10,]    0.0000    0.00000    0.00000    0.0000    0.00000    0.00000
    ##            [,7]      [,8]      [,9]     [,10]
    ##  [1,]    0.0000    0.0000    0.0000    0.0000
    ##  [2,]    0.0000    0.0000    0.0000    0.0000
    ##  [3,]    0.0000    0.0000    0.0000    0.0000
    ##  [4,]    0.0000    0.0000    0.0000    0.0000
    ##  [5,]    0.0000    0.0000    0.0000    0.0000
    ##  [6,] -300.5476    0.0000    0.0000    0.0000
    ##  [7,]  613.7665 -318.2136    0.0000    0.0000
    ##  [8,] -318.2136  836.1205 -347.6827    0.0000
    ##  [9,]    0.0000 -347.6827  475.2660 -272.5037
    ## [10,]    0.0000    0.0000 -272.5037  200.0000

``` r
forward.hessian(target, X)
```

    ##            [,1]       [,2]       [,3]      [,4]       [,5]       [,6]
    ##  [1,]  146.1314 -173.48524    0.00000    0.0000    0.00000    0.00000
    ##  [2,] -173.4852  -44.13221  -81.59709    0.0000    0.00000    0.00000
    ##  [3,]    0.0000  -81.59709  731.65931 -296.0679    0.00000    0.00000
    ##  [4,]    0.0000    0.00000 -296.06785  230.4825 -127.76200    0.00000
    ##  [5,]    0.0000    0.00000    0.00000 -127.7620  -32.36078  -93.94096
    ##  [6,]    0.0000    0.00000    0.00000    0.0000  -93.94096  561.25267
    ##  [7,]    0.0000    0.00000    0.00000    0.0000    0.00000 -300.54756
    ##  [8,]    0.0000    0.00000    0.00000    0.0000    0.00000    0.00000
    ##  [9,]    0.0000    0.00000    0.00000    0.0000    0.00000    0.00000
    ## [10,]    0.0000    0.00000    0.00000    0.0000    0.00000    0.00000
    ##            [,7]      [,8]      [,9]     [,10]
    ##  [1,]    0.0000    0.0000    0.0000    0.0000
    ##  [2,]    0.0000    0.0000    0.0000    0.0000
    ##  [3,]    0.0000    0.0000    0.0000    0.0000
    ##  [4,]    0.0000    0.0000    0.0000    0.0000
    ##  [5,]    0.0000    0.0000    0.0000    0.0000
    ##  [6,] -300.5476    0.0000    0.0000    0.0000
    ##  [7,]  613.7665 -318.2136    0.0000    0.0000
    ##  [8,] -318.2136  836.1205 -347.6827    0.0000
    ##  [9,]    0.0000 -347.6827  475.2660 -272.5037
    ## [10,]    0.0000    0.0000 -272.5037  200.0000

``` r
reverse.hessian(target, X)
```

    ##            [,1]       [,2]       [,3]      [,4]       [,5]       [,6]
    ##  [1,]  146.1314 -173.48524    0.00000    0.0000    0.00000    0.00000
    ##  [2,] -173.4852  -44.13221  -81.59709    0.0000    0.00000    0.00000
    ##  [3,]    0.0000  -81.59709  731.65931 -296.0679    0.00000    0.00000
    ##  [4,]    0.0000    0.00000 -296.06785  230.4825 -127.76200    0.00000
    ##  [5,]    0.0000    0.00000    0.00000 -127.7620  -32.36078  -93.94096
    ##  [6,]    0.0000    0.00000    0.00000    0.0000  -93.94096  561.25267
    ##  [7,]    0.0000    0.00000    0.00000    0.0000    0.00000 -300.54756
    ##  [8,]    0.0000    0.00000    0.00000    0.0000    0.00000    0.00000
    ##  [9,]    0.0000    0.00000    0.00000    0.0000    0.00000    0.00000
    ## [10,]    0.0000    0.00000    0.00000    0.0000    0.00000    0.00000
    ##            [,7]      [,8]      [,9]     [,10]
    ##  [1,]    0.0000    0.0000    0.0000    0.0000
    ##  [2,]    0.0000    0.0000    0.0000    0.0000
    ##  [3,]    0.0000    0.0000    0.0000    0.0000
    ##  [4,]    0.0000    0.0000    0.0000    0.0000
    ##  [5,]    0.0000    0.0000    0.0000    0.0000
    ##  [6,] -300.5476    0.0000    0.0000    0.0000
    ##  [7,]  613.7665 -318.2136    0.0000    0.0000
    ##  [8,] -318.2136  836.1205 -347.6827    0.0000
    ##  [9,]    0.0000 -347.6827  475.2660 -272.5037
    ## [10,]    0.0000    0.0000 -272.5037  200.0000

And we can compare the results with
    `numDeriv`:

``` r
numDeriv::grad(target, X)
```

    ##  [1]  -3.888505 -55.415065 206.827204 -64.021398 -40.366665  69.325287
    ##  [7] -29.417345  72.824136 -82.270277  49.012622

``` r
numDeriv::jacobian(function(x) numDeriv::grad(target, x), X)
```

    ##                [,1]          [,2]          [,3]          [,4]
    ##  [1,]  1.461309e+02 -1.734864e+02 -2.987210e-04  6.916644e-04
    ##  [2,] -1.734864e+02 -4.413523e+01 -8.159651e+01 -1.417676e-03
    ##  [3,] -2.987203e-04 -8.159651e+01  7.316593e+02 -2.960678e+02
    ##  [4,]  6.916616e-04 -1.417673e-03 -2.960678e+02  2.304827e+02
    ##  [5,]  7.790455e-04 -1.691067e-03 -5.314002e-04 -1.277617e+02
    ##  [6,] -1.738449e-06  1.145838e-04  1.435584e-04 -3.196785e-04
    ##  [7,] -1.179116e-06  7.773015e-05  4.112620e-09  5.282665e-05
    ##  [8,]  2.051853e-07 -1.352630e-05 -7.156623e-10 -9.192689e-06
    ##  [9,]  8.235661e-07 -5.429145e-05 -2.872503e-09 -3.689733e-05
    ## [10,] -7.911355e-07  5.215354e-05  2.759389e-09  3.544437e-05
    ##                [,5]          [,6]          [,7]          [,8]
    ##  [1,]  7.790458e-04 -1.738522e-06 -1.179158e-06  2.051894e-07
    ##  [2,] -1.691065e-03  1.145842e-04  7.772973e-05 -1.352602e-05
    ##  [3,] -5.313991e-04  1.435602e-04  5.177897e-09 -9.010239e-10
    ##  [4,] -1.277617e+02 -3.196801e-04  5.282577e-05 -9.192396e-06
    ##  [5,] -3.236261e+01 -9.394119e+01 -7.184548e-05  1.250208e-05
    ##  [6,] -9.394119e+01  5.612526e+02 -3.005475e+02 -3.789857e-06
    ##  [7,] -7.184553e-05 -3.005475e+02  6.137667e+02 -3.182136e+02
    ##  [8,]  1.250228e-05 -3.790054e-06 -3.182136e+02  8.361204e+02
    ##  [9,]  5.018127e-05 -1.521240e-05  1.436787e-05 -3.476826e+02
    ## [10,] -4.820521e-05  1.461336e-05 -1.380208e-05 -1.223748e-05
    ##                [,9]         [,10]
    ##  [1,]  8.235590e-07 -7.911382e-07
    ##  [2,] -5.428942e-05  5.215222e-05
    ##  [3,] -2.411041e-09  2.316127e-09
    ##  [4,] -3.689737e-05  3.544484e-05
    ##  [5,]  5.018221e-05 -4.820670e-05
    ##  [6,] -1.521247e-05  1.461360e-05
    ##  [7,]  1.436740e-05 -1.380180e-05
    ##  [8,] -3.476826e+02 -1.223725e-05
    ##  [9,]  4.752660e+02 -2.725037e+02
    ## [10,] -2.725037e+02  2.000000e+02

``` r
numDeriv::hessian(target, X)
```

    ##                [,1]          [,2]          [,3]          [,4]
    ##  [1,]  1.461314e+02 -1.734852e+02  4.098559e-10 -9.485573e-10
    ##  [2,] -1.734852e+02 -4.413221e+01 -8.159709e+01 -1.680190e-10
    ##  [3,]  4.098559e-10 -8.159709e+01  7.316593e+02 -2.960679e+02
    ##  [4,] -9.485573e-10 -1.680190e-10 -2.960679e+02  2.304825e+02
    ##  [5,] -1.184242e-09 -2.746336e-09  4.721632e-14 -1.277620e+02
    ##  [6,] -3.317681e-11 -9.289379e-10  2.518398e-13 -5.476665e-10
    ##  [7,] -3.135911e-11  7.430552e-10  2.228494e-13 -1.566970e-13
    ##  [8,]  3.206768e-10 -1.210250e-10  6.798436e-13  9.611677e-13
    ##  [9,]  1.861648e-10  3.564298e-10  1.720973e-13  7.738142e-13
    ## [10,]  1.963387e-10  3.796110e-10  1.058214e-11  3.444005e-13
    ##                [,5]          [,6]          [,7]          [,8]
    ##  [1,] -1.184242e-09 -3.317681e-11 -3.135911e-11  3.206768e-10
    ##  [2,] -2.746336e-09 -9.289379e-10  7.430552e-10 -1.210250e-10
    ##  [3,]  4.721632e-14  2.518398e-13  2.228494e-13  6.798436e-13
    ##  [4,] -1.277620e+02 -5.476665e-10 -1.566970e-13  9.611677e-13
    ##  [5,] -3.236078e+01 -9.394096e+01 -2.111816e-13  4.863695e-13
    ##  [6,] -9.394096e+01  5.612527e+02 -3.005476e+02 -1.614259e-11
    ##  [7,] -2.111816e-13 -3.005476e+02  6.137665e+02 -3.182136e+02
    ##  [8,]  4.863695e-13 -1.614259e-11 -3.182136e+02  8.361205e+02
    ##  [9,]  5.117756e-15 -2.095245e-11  1.213138e-10 -3.476827e+02
    ## [10,] -3.355256e-14 -1.018215e-11  1.165267e-10  8.952503e-11
    ##                [,9]         [,10]
    ##  [1,]  1.861648e-10  1.963387e-10
    ##  [2,]  3.564298e-10  3.796110e-10
    ##  [3,]  1.720973e-13  1.058214e-11
    ##  [4,]  7.738142e-13  3.444005e-13
    ##  [5,]  5.117756e-15 -3.355256e-14
    ##  [6,] -2.095245e-11 -1.018215e-11
    ##  [7,]  1.213138e-10  1.165267e-10
    ##  [8,] -3.476827e+02  8.952503e-11
    ##  [9,]  4.752660e+02 -2.725037e+02
    ## [10,] -2.725037e+02  2.000000e+02

We can see the result is similar, and results from `autodiffr` should be
more accurate.

## More Advantage Usage

### Use of config object

If gradient or hessian of the same target function need to be caculated
repeatedly on inputs of the same shape, like input vectors of same
length or input matrices with the same number of rows and columns, then
users can caculate config objects before to improve the performance:

``` r
cfg <- forward.grad.config(target, X)
forward.grad(target, X, cfg = cfg)
```

    ##  [1]  -3.888505 -55.415065 206.827204 -64.021398 -40.366665  69.325287
    ##  [7] -29.417345  72.824136 -82.270277  49.012622

``` r
cfg <- reverse.grad.config(X)
reverse.grad(target, X, cfg = cfg)
```

    ##  [1]  -3.888505 -55.415065 206.827204 -64.021398 -40.366665  69.325287
    ##  [7] -29.417345  72.824136 -82.270277  49.012622

``` r
cfg <- forward.hessian.config(target, X)
forward.hessian(target, X, cfg = cfg)
```

    ##            [,1]       [,2]       [,3]      [,4]       [,5]       [,6]
    ##  [1,]  146.1314 -173.48524    0.00000    0.0000    0.00000    0.00000
    ##  [2,] -173.4852  -44.13221  -81.59709    0.0000    0.00000    0.00000
    ##  [3,]    0.0000  -81.59709  731.65931 -296.0679    0.00000    0.00000
    ##  [4,]    0.0000    0.00000 -296.06785  230.4825 -127.76200    0.00000
    ##  [5,]    0.0000    0.00000    0.00000 -127.7620  -32.36078  -93.94096
    ##  [6,]    0.0000    0.00000    0.00000    0.0000  -93.94096  561.25267
    ##  [7,]    0.0000    0.00000    0.00000    0.0000    0.00000 -300.54756
    ##  [8,]    0.0000    0.00000    0.00000    0.0000    0.00000    0.00000
    ##  [9,]    0.0000    0.00000    0.00000    0.0000    0.00000    0.00000
    ## [10,]    0.0000    0.00000    0.00000    0.0000    0.00000    0.00000
    ##            [,7]      [,8]      [,9]     [,10]
    ##  [1,]    0.0000    0.0000    0.0000    0.0000
    ##  [2,]    0.0000    0.0000    0.0000    0.0000
    ##  [3,]    0.0000    0.0000    0.0000    0.0000
    ##  [4,]    0.0000    0.0000    0.0000    0.0000
    ##  [5,]    0.0000    0.0000    0.0000    0.0000
    ##  [6,] -300.5476    0.0000    0.0000    0.0000
    ##  [7,]  613.7665 -318.2136    0.0000    0.0000
    ##  [8,] -318.2136  836.1205 -347.6827    0.0000
    ##  [9,]    0.0000 -347.6827  475.2660 -272.5037
    ## [10,]    0.0000    0.0000 -272.5037  200.0000

``` r
cfg <- reverse.hessian.config(X)
reverse.hessian(target, X, cfg = cfg)
```

    ##            [,1]       [,2]       [,3]      [,4]       [,5]       [,6]
    ##  [1,]  146.1314 -173.48524    0.00000    0.0000    0.00000    0.00000
    ##  [2,] -173.4852  -44.13221  -81.59709    0.0000    0.00000    0.00000
    ##  [3,]    0.0000  -81.59709  731.65931 -296.0679    0.00000    0.00000
    ##  [4,]    0.0000    0.00000 -296.06785  230.4825 -127.76200    0.00000
    ##  [5,]    0.0000    0.00000    0.00000 -127.7620  -32.36078  -93.94096
    ##  [6,]    0.0000    0.00000    0.00000    0.0000  -93.94096  561.25267
    ##  [7,]    0.0000    0.00000    0.00000    0.0000    0.00000 -300.54756
    ##  [8,]    0.0000    0.00000    0.00000    0.0000    0.00000    0.00000
    ##  [9,]    0.0000    0.00000    0.00000    0.0000    0.00000    0.00000
    ## [10,]    0.0000    0.00000    0.00000    0.0000    0.00000    0.00000
    ##            [,7]      [,8]      [,9]     [,10]
    ##  [1,]    0.0000    0.0000    0.0000    0.0000
    ##  [2,]    0.0000    0.0000    0.0000    0.0000
    ##  [3,]    0.0000    0.0000    0.0000    0.0000
    ##  [4,]    0.0000    0.0000    0.0000    0.0000
    ##  [5,]    0.0000    0.0000    0.0000    0.0000
    ##  [6,] -300.5476    0.0000    0.0000    0.0000
    ##  [7,]  613.7665 -318.2136    0.0000    0.0000
    ##  [8,] -318.2136  836.1205 -347.6827    0.0000
    ##  [9,]    0.0000 -347.6827  475.2660 -272.5037
    ## [10,]    0.0000    0.0000 -272.5037  200.0000

And users can also choose a chunk size when using config objects for
forward mode automatic differentiation, choosing appropriate sample size
can improve performance further.

``` r
cfg1 <- forward.grad.config(target, X, chunk_size = 1)
forward.grad(target, X, cfg = cfg1)
```

    ##  [1]  -3.888505 -55.415065 206.827204 -64.021398 -40.366665  69.325287
    ##  [7] -29.417345  72.824136 -82.270277  49.012622

``` r
cfg1 <- forward.hessian.config(target, X, chunk_size = 1)
forward.hessian(target, X, cfg = cfg1)
```

    ##            [,1]       [,2]       [,3]      [,4]       [,5]       [,6]
    ##  [1,]  146.1314 -173.48524    0.00000    0.0000    0.00000    0.00000
    ##  [2,] -173.4852  -44.13221  -81.59709    0.0000    0.00000    0.00000
    ##  [3,]    0.0000  -81.59709  731.65931 -296.0679    0.00000    0.00000
    ##  [4,]    0.0000    0.00000 -296.06785  230.4825 -127.76200    0.00000
    ##  [5,]    0.0000    0.00000    0.00000 -127.7620  -32.36078  -93.94096
    ##  [6,]    0.0000    0.00000    0.00000    0.0000  -93.94096  561.25267
    ##  [7,]    0.0000    0.00000    0.00000    0.0000    0.00000 -300.54756
    ##  [8,]    0.0000    0.00000    0.00000    0.0000    0.00000    0.00000
    ##  [9,]    0.0000    0.00000    0.00000    0.0000    0.00000    0.00000
    ## [10,]    0.0000    0.00000    0.00000    0.0000    0.00000    0.00000
    ##            [,7]      [,8]      [,9]     [,10]
    ##  [1,]    0.0000    0.0000    0.0000    0.0000
    ##  [2,]    0.0000    0.0000    0.0000    0.0000
    ##  [3,]    0.0000    0.0000    0.0000    0.0000
    ##  [4,]    0.0000    0.0000    0.0000    0.0000
    ##  [5,]    0.0000    0.0000    0.0000    0.0000
    ##  [6,] -300.5476    0.0000    0.0000    0.0000
    ##  [7,]  613.7665 -318.2136    0.0000    0.0000
    ##  [8,] -318.2136  836.1205 -347.6827    0.0000
    ##  [9,]    0.0000 -347.6827  475.2660 -272.5037
    ## [10,]    0.0000    0.0000 -272.5037  200.0000

### Use of tape object in reverse mode automatic differentiation

In reverse mode automatic differentiation, if the target function are
defined without any branching, like `if`, `ifelse`, `while` and etc,
then it is possible to use `tape` to further improve performance:

``` r
tp <- reverse.grad.tape(target, X)
reverse.grad(tp, X)
```

    ##  [1]  -3.888505 -55.415065 206.827204 -64.021398 -40.366665  69.325287
    ##  [7] -29.417345  72.824136 -82.270277  49.012622

``` r
tp <- reverse.hessian.tape(target, X)
reverse.hessian(tp, X)
```

    ##            [,1]       [,2]       [,3]      [,4]       [,5]       [,6]
    ##  [1,]  146.1314 -173.48524    0.00000    0.0000    0.00000    0.00000
    ##  [2,] -173.4852  -44.13221  -81.59709    0.0000    0.00000    0.00000
    ##  [3,]    0.0000  -81.59709  731.65931 -296.0679    0.00000    0.00000
    ##  [4,]    0.0000    0.00000 -296.06785  230.4825 -127.76200    0.00000
    ##  [5,]    0.0000    0.00000    0.00000 -127.7620  -32.36078  -93.94096
    ##  [6,]    0.0000    0.00000    0.00000    0.0000  -93.94096  561.25267
    ##  [7,]    0.0000    0.00000    0.00000    0.0000    0.00000 -300.54756
    ##  [8,]    0.0000    0.00000    0.00000    0.0000    0.00000    0.00000
    ##  [9,]    0.0000    0.00000    0.00000    0.0000    0.00000    0.00000
    ## [10,]    0.0000    0.00000    0.00000    0.0000    0.00000    0.00000
    ##            [,7]      [,8]      [,9]     [,10]
    ##  [1,]    0.0000    0.0000    0.0000    0.0000
    ##  [2,]    0.0000    0.0000    0.0000    0.0000
    ##  [3,]    0.0000    0.0000    0.0000    0.0000
    ##  [4,]    0.0000    0.0000    0.0000    0.0000
    ##  [5,]    0.0000    0.0000    0.0000    0.0000
    ##  [6,] -300.5476    0.0000    0.0000    0.0000
    ##  [7,]  613.7665 -318.2136    0.0000    0.0000
    ##  [8,] -318.2136  836.1205 -347.6827    0.0000
    ##  [9,]    0.0000 -347.6827  475.2660 -272.5037
    ## [10,]    0.0000    0.0000 -272.5037  200.0000
